---

title: Core vision
keywords: fastai
sidebar: home_sidebar

summary: "Basic image opening/processing functionality"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dev/06_vision_core.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="n">fns</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">fns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fn</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/home/ubuntu/git/fastai_docs/dev/data/mnist_tiny/test/4605.png&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="image_convert" class="doc_header"><code>image_convert</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>image_convert</code>(<strong><code>img</code></strong>, <strong><code>mode</code></strong>=<em><code>'RGB'</code></em>)</p>
</blockquote>
<p>Convert <code>img</code> to <code>mode</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageConverter" class="doc_header"><code>ImageConverter</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageConverter</code>(<strong><code>mode</code></strong>=<em><code>'RGB'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ImageConverter</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="image_resize" class="doc_header"><code>image_resize</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>image_resize</code>(<strong><code>img</code></strong>, <strong><code>size</code></strong>, <strong><code>resample</code></strong>=<em><code>2</code></em>)</p>
</blockquote>
<p>Resize image to <code>size</code> using `resample</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageResizer" class="doc_header"><code>ImageResizer</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageResizer</code>(<strong><code>size</code></strong>, <strong><code>resample</code></strong>=<em><code>2</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ImageResizer</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAA30lEQVR4nGNgGHAge+v/cl3sUkrTf/79+zcazmdBklPeroyqmAnBbDmnzPBiLXYzW3/+/TtBJB3ZWAS49/evLwfDduySShv7ORjiPv+9w4fNXH4OBrNPf98HYreVQXTX37/n8cj9/bxeApucyK6/f/+iBAKSPx2dGRi+nPnAII1NZ9jfD+tsGDb8vQsXQQq+4+EvjjBw8jC8xtTHG8nAwMDA0IE1EJJvSTAwMBg9+vsTi0eT/1aLiJg9/vurCYtz4v5APHISm1sZbvz5+/fvjxkqWCUZpvz9O0MBuxQdAQDYKl1usylDbwAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="image2byte" class="doc_header"><code>image2byte</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>image2byte</code>(<strong><code>img</code></strong>)</p>
</blockquote>
<p>Transform image to byte tensor in <code>c*h*w</code> dim order.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unpermute_image" class="doc_header"><code>unpermute_image</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unpermute_image</code>(<strong><code>img</code></strong>)</p>
</blockquote>
<p>Convert <code>c*h*w</code> dim order to <code>h*w*c</code> (or just <code>h*w</code> if 1 channel)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageToByteTensor" class="doc_header"><code>ImageToByteTensor</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageToByteTensor</code>()</p>
</blockquote>
<p>Transform image to byte tensor in <code>c*h*w</code> dim order.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">ImageToByteTensor</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The transformation to tensors is done in two steps just in case you want to apply transforms to byte tensors or want to use the GPU for converting to floats. The permutation of axes needs to be reversed for display, so we define <code>decodes</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ByteToFloatTensor" class="doc_header"><code>class</code> <code>ByteToFloatTensor</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/06_vision_core.ipynb" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ByteToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>True</code></em>) :: <a href="/data.pipeline.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">ByteToFloatTensor</span><span class="p">()</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">1.</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

